
<!DOCTYPE html>
<html>

<head>
	<title>App Events</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" id="themeJQ" href="../css/themes/default/theme-default.min.css"/>
	<link rel="stylesheet" href="../css/themes/default/jquery.mobile.structure-1.2.0.min.css"/>
	<link rel="stylesheet" id="themePrism" href="../css/themes/prism/default.min.css"/>
	<link rel="stylesheet" id="themeDocs" href="../css/docs-default.min.css"/>
	<script src="../js/energize-min.js"></script>
	<script src="../js/jquery-1.8.1.min.js"></script>
	<script src="../../app.js"></script>
	<script src="../js/common.js"></script>
	<script src="../js/example.js"></script>
	<script src="../js/jquery.mobile-1.2.0.min.js"></script>
</head>

<body>

<div data-role="page" data-theme="a" >

	<div data-role="header">
		<a href='#' class='ui-btn-left' data-icon='arrow-l' onclick="history.back(); return false">Back</a>
		<h1>App Events</h1>
		<a class="ui-btn-right" data-icon="gear" data-iconpos="notext" onclick="setTheme(getTheme() == 'default' ? 'dark' : 'default')"></a>
	</div><!-- /header -->

	<div data-role="content">
		<p>In your app you can use various event functions which will be automatically called by DroidScript.</p>
		<h3>OnStart()</h3>
		<p>This is probably the most popular one. It will be called when DroidScript has initialized and it is the last function which will be called from global scope. That means every timeout you might have set will be called <b>after</b> OnStart was called.<br>
		When OnStart has returned, the apps '<b>started</b>' state will be set to <span class="token boolean">true</span>. Therefore <b>app.<a href="IsStarted.htm" data-ajax="false">IsStarted</a>()</b> method will return <span class="token boolean">true</span> as well.</p>

		<div data-role="collapsible" data-collapsed="true" data-mini="true" data-theme="a" data-content-theme="a">
			<h3>Example - OnStart</h3>
			<div id="examp1" style="font-size:70%">
				<span class="token function">setTimeout</span><span class="token punctuation">(</span>OnLoad<span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				<br>
				<b id="snip1" style="font-size:100%"><span class="token keyword">function</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>
				    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"called OnStart\nApp Started: "</span> <span class="token operator">+</span> app<span class="token punctuation">.</span><span class="token function">IsStarted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				<span class="token punctuation">}</span></b><br>
				<br>
				<span class="token keyword">function</span> <span class="token function">OnLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>
				    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"called OnLoad\nApp Started: "</span> <span class="token operator">+</span> app<span class="token punctuation">.</span><span class="token function">IsStarted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				<span class="token punctuation">}</span>
			</div>
			<div name="divCopy" align="right">
			<a href="#" data-role="button" data-mini="true" data-inline="true" onclick="copy( snip1 )">    Copy    </a>
			<a href="#" data-role="button" data-mini="true" data-inline="true" onclick="copy( examp1 )">Copy All</a>
			<a href="#" data-role="button" data-mini="true" data-inline="true" onclick="demo( examp1 )">      Run      </a>
			</div>
		</div>

		<h3>OnMenu(name)</h3>
		<p>This event is called when the user selects an item from the in-app menu.<br>
		See Also: <a href="../app/SetMenu.htm" data-ajax="false">SetMenu</a>, <a href="../app/ShowMenu.htm" data-ajax="false">ShowMenu</a></p>

		<div data-role="collapsible" data-collapsed="true" data-mini="true" data-theme="a" data-content-theme="a">
			<h3>Example - OnMenu</h3>
			<div id="examp2" style="font-size:70%">
				<span class="token keyword">function</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>
				<span class="token punctuation">{</span><br>
				    <b id="snip2" style="font-size:100%">app<span class="token punctuation">.</span><span class="token function">SetMenu</span><span class="token punctuation">(</span> <span class="token string">"Start,Stop,Pause"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></b><br>
				<br>
				    lay <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token function">CreateLayout</span><span class="token punctuation">(</span> <span class="token string">"linear"</span><span class="token punctuation">,</span> <span class="token string">""</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				<br>
				    btn <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token function">CreateButton</span><span class="token punctuation">(</span> <span class="token string">"[fa-gear]"</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"fontawesome"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				    btn<span class="token punctuation">.</span><span class="token function">SetOnTouch</span><span class="token punctuation">(</span> app<span class="token punctuation">.</span>ShowMenu <span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				    lay<span class="token punctuation">.</span><span class="token function">AddChild</span><span class="token punctuation">(</span> btn <span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				<br>
				    app<span class="token punctuation">.</span><span class="token function">AddLayout</span><span class="token punctuation">(</span> lay <span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				<span class="token punctuation">}</span><br>
				<br>
				<span class="token keyword">function</span> <span class="token function">OnMenu</span><span class="token punctuation">(</span> <span class="token parameter">item</span> <span class="token punctuation">)</span><br>
				<span class="token punctuation">{</span><br>
				    app<span class="token punctuation">.</span><span class="token function">ShowPopup</span><span class="token punctuation">(</span> item<span class="token punctuation">,</span> <span class="token string">"Short"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				<span class="token punctuation">}</span>
			</div>
			<div name="divCopy" align="right">
			<a href="#" data-role="button" data-mini="true" data-inline="true" onclick="copy( snip2 )">    Copy    </a>
			<a href="#" data-role="button" data-mini="true" data-inline="true" onclick="copy( examp2 )">Copy All</a>
			<a href="#" data-role="button" data-mini="true" data-inline="true" onclick="demo( examp2 )">      Run      </a>
			</div>
		</div>

		<h3>OnBack()</h3>
		<p>By default the app closes if the user presses the devices back-button. However, you can disable that behaviour by calling app<span class="token punctuation">.</span><a href="../app/EnableBackKey.htm" data-ajax="false">EnableBackKey</a><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>.<br>
		In this case the OnBack event will be called instead of closing the app. This can be useful to create a confirmation dialog before exiting:</p>

		<div data-role="collapsible" data-collapsed="true" data-mini="true" data-theme="a" data-content-theme="a">
			<h3>Example - Confirm Exit</h3>
			<div id="examp3" style="font-size:70%">
				<span class="token keyword">function</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>
				<span class="token punctuation">{</span><br>
				    app<span class="token punctuation">.</span><span class="token function">EnableBackKey</span><span class="token punctuation">(</span> <span class="token boolean">false</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				<br>
				    yndExit <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token function">CreateYesNoDialog</span><span class="token punctuation">(</span><span class="token string">"Exit App?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				    yndExit<span class="token punctuation">.</span><span class="token function">SetOnTouch</span><span class="token punctuation">(</span> yndExit_OnTouch <span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				<br>
				    app<span class="token punctuation">.</span><span class="token function">ShowPopup</span><span class="token punctuation">(</span> <span class="token string">"Press the back button"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				<span class="token punctuation">}</span><br>
				<br>
				<span class="token keyword">function</span> <span class="token function">yndExit_OnTouch</span><span class="token punctuation">(</span><span class="token parameter">reply</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>
				    <span class="token keyword">if</span><span class="token punctuation">(</span>reply <span class="token operator">==</span> <span class="token string">"Yes"</span><span class="token punctuation">)</span> app<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				<span class="token punctuation">}</span><br>
				<br>
				<b id="snip3" style="font-size:100%"><span class="token keyword">function</span> <span class="token function">OnBack</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>
				    yndExit<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				<span class="token punctuation">}</span></b>
			</div>
			<div name="divCopy" align="right">
			<a href="#" data-role="button" data-mini="true" data-inline="true" onclick="copy( snip3 )">    Copy    </a>
			<a href="#" data-role="button" data-mini="true" data-inline="true" onclick="copy( examp3 )">Copy All</a>
			<a href="#" data-role="button" data-mini="true" data-inline="true" onclick="demo( examp3 )">      Run      </a>
			</div>
		</div>

		<h3>OnPause()</h3>
		<p>The OnPause event will be called when the user sends the app to the background, ie. when pressing the home button.</p>

		<div data-role="collapsible" data-collapsed="true" data-mini="true" data-theme="a" data-content-theme="a">
			<h3>Example - Detect Pause</h3>
			<div id="examp4" style="font-size:70%">
				<span class="token comment">//Called when application is paused.</span><br>
				<span class="token keyword">function</span> <span class="token function">OnPause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>
				<span class="token punctuation">{</span><br>
				    app<span class="token punctuation">.</span><span class="token function">ShowPopup</span><span class="token punctuation">(</span> <span class="token string">"OnPause"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				<span class="token punctuation">}</span>
			</div>
			<div name="divCopy" align="right">
			<a href="#" data-role="button" data-mini="true" data-inline="true" onclick="copy( examp4 )">Copy All</a>
			<a href="#" data-role="button" data-mini="true" data-inline="true" onclick="demo( examp4 )">      Run      </a>
			</div>
		</div>

		<h3>OnResume()</h3>
		<p>The OnPause event will be called when the user returns to your app after sending it to the background.</p>

		<div data-role="collapsible" data-collapsed="true" data-mini="true" data-theme="a" data-content-theme="a">
			<h3>Example - Detect Resume</h3>
			<div id="examp5" style="font-size:70%">
				<span class="token comment">//Called when application is resumed.</span><br>
				<span class="token keyword">function</span> <span class="token function">OnResume</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>
				<span class="token punctuation">{</span><br>
				    app<span class="token punctuation">.</span><span class="token function">ShowPopup</span><span class="token punctuation">(</span> <span class="token string">"OnResume"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				<span class="token punctuation">}</span>
			</div>
			<div name="divCopy" align="right">
			<a href="#" data-role="button" data-mini="true" data-inline="true" onclick="copy( examp5 )">Copy All</a>
			<a href="#" data-role="button" data-mini="true" data-inline="true" onclick="demo( examp5 )">      Run      </a>
			</div>
		</div>

		<h3>OnConfig()</h3>
		<p>OnConfig is called when a device configuration changes, especially the screen orientation. This can be used to rearrange your layouts on orientation change.</p>

		<div data-role="collapsible" data-collapsed="true" data-mini="true" data-theme="a" data-content-theme="a">
			<h3>Example - Layout Orientation</h3>
			<div id="examp6" style="font-size:70%">
				<span class="token keyword">function</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>
				<span class="token punctuation">{</span><br>
				    lay <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token function">CreateLayout</span><span class="token punctuation">(</span> <span class="token string">"linear"</span><span class="token punctuation">,</span> <span class="token string">"VCenter,FillXY"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				<br>
				    txt1 <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token function">CreateText</span><span class="token punctuation">(</span> <span class="token string">""</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				    txt1<span class="token punctuation">.</span><span class="token function">SetTextSize</span><span class="token punctuation">(</span> <span class="token number">64</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				    lay<span class="token punctuation">.</span><span class="token function">AddChild</span><span class="token punctuation">(</span> txt1 <span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				<br>
				    txt2 <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token function">CreateText</span><span class="token punctuation">(</span> <span class="token string">""</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				    txt2<span class="token punctuation">.</span><span class="token function">SetTextSize</span><span class="token punctuation">(</span> <span class="token number">64</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				    lay<span class="token punctuation">.</span><span class="token function">AddChild</span><span class="token punctuation">(</span> txt2 <span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				    <span class="token function">OnConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				<br>
				    app<span class="token punctuation">.</span><span class="token function">AddLayout</span><span class="token punctuation">(</span> lay <span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				<span class="token punctuation">}</span><br>
				<br>
				<b id="snip6" style="font-size:100%"><span class="token comment">//Called when screen rotates</span><br>
				<span class="token keyword">function</span> <span class="token function">OnConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>
				<span class="token punctuation">{</span><br>
				    <span class="token keyword">var</span> orient <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token function">GetOrientation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				    txt1<span class="token punctuation">.</span><span class="token function">SetText</span><span class="token punctuation">(</span>orient<span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				<br>
				    <span class="token keyword">if</span><span class="token punctuation">(</span>orient <span class="token operator">==</span> <span class="token string">"Portrait"</span><span class="token punctuation">)</span> orient <span class="token operator">=</span> <span class="token string">"Vertical"</span><span class="token punctuation">;</span><br>
				    <span class="token keyword">else</span> orient <span class="token operator">=</span> <span class="token string">"Horizontal"</span><span class="token punctuation">;</span><br>
				<br>
				    lay<span class="token punctuation">.</span><span class="token function">SetOrientation</span><span class="token punctuation">(</span> orient <span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				    txt2<span class="token punctuation">.</span><span class="token function">SetText</span><span class="token punctuation">(</span> orient <span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				<span class="token punctuation">}</span></b>
			</div>
			<div name="divCopy" align="right">
			<a href="#" data-role="button" data-mini="true" data-inline="true" onclick="copy( snip6 )">    Copy    </a>
			<a href="#" data-role="button" data-mini="true" data-inline="true" onclick="copy( examp6 )">Copy All</a>
			<a href="#" data-role="button" data-mini="true" data-inline="true" onclick="demo( examp6 )">      Run      </a>
			</div>
		</div>

		<h3>OnAlarm()</h3>
		<p>If you have set up an app <a href="../app/SetAlarm" onclick="return OpenUrl(this.href);">Alarm</a> and it is triggered it will call the OnAlarm event.</p>

		<div data-role="collapsible" data-collapsed="true" data-mini="true" data-theme="a" data-content-theme="a">
			<h3>Example - OnAlarm</h3>
			<div id="examp7" style="font-size:70%">
				<span class="token keyword">function</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>
				<span class="token punctuation">{</span><br>
				    <span class="token keyword">var</span> now <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				    app<span class="token punctuation">.</span><span class="token function">SetAlarm</span><span class="token punctuation">(</span> <span class="token string">"Set"</span><span class="token punctuation">,</span> <span class="token number">1234</span><span class="token punctuation">,</span> OnAlarm<span class="token punctuation">,</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">3000</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				    <span class="token comment">// app.ToBack();</span><br>
				    <span class="token comment">// app.Exit();</span><br>
				<span class="token punctuation">}</span><br>
				<br>
				<span class="token comment">//Called when alarm is triggered.</span><br>
				<span class="token comment">//(Even if your app is closed)</span><br>
				<b id="snip7" style="font-size:100%"><span class="token keyword">function</span> <span class="token function">OnAlarm</span><span class="token punctuation">(</span> <span class="token parameter">id</span> <span class="token punctuation">)</span><br>
				<span class="token punctuation">{</span><br>
				    app<span class="token punctuation">.</span><span class="token function">ShowPopup</span><span class="token punctuation">(</span> <span class="token string">"Got Alarm: id = "</span> <span class="token operator">+</span> id <span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				<span class="token punctuation">}</span></b>
			</div>
			<div name="divCopy" align="right">
			<a href="#" data-role="button" data-mini="true" data-inline="true" onclick="copy( snip7 )">    Copy    </a>
			<a href="#" data-role="button" data-mini="true" data-inline="true" onclick="copy( examp7 )">Copy All</a>
			<a href="#" data-role="button" data-mini="true" data-inline="true" onclick="demo( examp7 )">      Run      </a>
			</div>
		</div>

		<h3>OnData()</h3>
		<p>When an other app has sent an intent to your app you will get notified by the OnData event. Then you can retrieve the intent object using the app.<a href="../app/GetIntent.htm" data-ajax="false">GetIntent</a>() method.</p>

		<div data-role="collapsible" data-collapsed="true" data-mini="true" data-theme="a" data-content-theme="a">
			<h3>Example - Received Intent Data</h3>
			<div id="examp8" style="font-size:70%">
				<span class="token comment">//Handle data sent from other apps.</span><br>
				<span class="token keyword">function</span> <span class="token function">OnData</span><span class="token punctuation">(</span> <span class="token parameter">isStartUp</span> <span class="token punctuation">)</span><br>
				<span class="token punctuation">{</span><br>
				    <span class="token comment">//Display intent data.</span><br>
				    <span class="token keyword">var</span> intent <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token function">GetIntent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				    <span class="token keyword">if</span><span class="token punctuation">(</span> intent <span class="token punctuation">)</span><br>
				    <span class="token punctuation">{</span><br>
				        <span class="token comment">//Extract main data.</span><br>
				        <span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token string">"action: "</span> <span class="token operator">+</span> intent<span class="token punctuation">.</span>action <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">;</span><br>
				        s <span class="token operator">+=</span> <span class="token string">"type: "</span> <span class="token operator">+</span> intent<span class="token punctuation">.</span>type <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">;</span><br>
				        s <span class="token operator">+=</span> <span class="token string">"data: "</span> <span class="token operator">+</span> intent<span class="token punctuation">.</span>data <span class="token operator">+</span> <span class="token string">"\n\n"</span><span class="token punctuation">;</span><br>
				<br>
				        <span class="token comment">//Extract extras.</span><br>
				        s <span class="token operator">+=</span> <span class="token string">"extras:\n"</span><span class="token punctuation">;</span><br>
				        <span class="token keyword">for</span><span class="token punctuation">(</span> <span class="token keyword">var</span> key <span class="token keyword">in</span> intent<span class="token punctuation">.</span>extras <span class="token punctuation">)</span><br>
				            s <span class="token operator">+=</span> key<span class="token operator">+</span><span class="token string">": "</span><span class="token operator">+</span>intent<span class="token punctuation">.</span>extras<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">;</span><br>
				<br>
				        app<span class="token punctuation">.</span><span class="token function">Alert</span><span class="token punctuation">(</span> s<span class="token punctuation">,</span> <span class="token string">"OnData"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><br>
				    <span class="token punctuation">}</span><br>
				<span class="token punctuation">}</span>
			</div>
			<div name="divCopy" align="right">
			<a href="#" data-role="button" data-mini="true" data-inline="true" onclick="copy( examp8 )">Copy All</a>
			<a href="#" data-role="button" data-mini="true" data-inline="true" onclick="demo( examp8 )">      Run      </a>
			</div>
		</div>

	</div><!-- /content -->

</div><!-- /page -->

</body>
</html>